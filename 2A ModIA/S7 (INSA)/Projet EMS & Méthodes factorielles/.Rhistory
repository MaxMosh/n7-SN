summary(Data_mlg)
Data_mlg <- Data_mlg[c(1,3,4,5)]
summary(Data_mlg)
glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = logit))
glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"), test="Chisq")
modelcomplet = glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcomplet)
pdeudoR2 = 1 - modelcomplet$null.deviance/modelcomplet$deviance
pseudoR2 = 1 - modelcomplet$null.deviance/modelcomplet$deviance
pseudoR2
pseudoR2 = 1 - modelcomplet$deviance/modelcomplet$null.deviance
pseudoR2
modelcomplet = glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
modelcomplet = glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcomplet)
bestglm(modelcomplet,family=binomial,IC="AIC")
bestglm(modelcomplet,family=binomial,IC="BIC")
library(bestglm)
bestglm(modelcomplet,family=binomial,IC="AIC")
bestglm(Data_mlg,family=binomial,IC="AIC")
bestglm(Data_mlg,family=binomial,IC="AIC")
step.backward = step(modelcomplet)
step.backward = step(modelcomplet, direction="backward",k=log(nrow(Data_mlg)))
bestglm(Data_mlg,family=binomial,IC="AIC")
# Les bestglm ne fonctionnent pas
#bestglm(Data_mlg,family=binomial,IC="AIC")
#bestglm(Data_mlg,family=binomial,IC="BIC")
step.backward = step(modelcomplet)
step.backward = step(modelcomplet, direction="backward",k=log(nrow(Data_mlg)))
# Ici je refais la séléction des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(10,12,14,15)]
summary(Data_mlg)
# Ici je refais la séléction des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(Data_mlg$ch4_t>1000)
summary(Data_mlg)
# Je retire la varaible quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
modelcomplet = glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcomplet)
pseudoR2 = 1 - modelcomplet$deviance/modelcomplet$null.deviance
pseudoR2
# Les bestglm ne fonctionnent pas
#bestglm(Data_mlg,family=binomial,IC="AIC")
#bestglm(Data_mlg,family=binomial,IC="BIC")
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcomplet)
step.backward = step(modelcomplet, direction="backward",k=log(nrow(Data_mlg)))
# Les bestglm ne fonctionnent pas
bestglm(Data_mlg,family=binomial,IC="AIC")
bestglm(Data_mlg,family=binomial,IC="BIC")
knitr::opts_chunk$set(echo = TRUE)
library(bestglm)
library(bestglm)
# Ici je refais la séléction des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(Data_mlg$ch4_t>1000)
summary(Data_mlg)
# Je retire la varaible quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
summary(Data_mlg)
head(Data_mlg)
```{r}
modelcomplet = glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcomplet)
modelcomplet = glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcomplet)
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcomplet)
step.backward = step(modelcomplet, direction="backward",k=log(nrow(Data_mlg)))
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter)
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg)))
# Les bestglm ne fonctionnent pas
bestglm(Data_mlg,family=binomial,IC="AIC")
bestglm(Data_mlg,family=binomial,IC="BIC")
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter)
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter)
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter)
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg)))
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg)))
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter)
anova(glm(dep_met_1000~annee_inv + nh3_kg + n2o_t + TypeEPCI + annee_inv:nh3_kg +
annee_inv:n2o_t + nh3_kg:n2o_t + nh3_kg:TypeEPCI + n2o_t:TypeEPCI ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter), modelcompletinter)
anova(glm(dep_met_1000~annee_inv + nh3_kg + n2o_t + TypeEPCI + annee_inv:nh3_kg +
annee_inv:n2o_t + nh3_kg:n2o_t + nh3_kg:TypeEPCI + n2o_t:TypeEPCI ,data=Data_mlg, family=binomial(link = "logit")), summary(modelcompletinter), modelcompletinter)
anova(glm(dep_met_1000~annee_inv + nh3_kg + n2o_t + TypeEPCI + annee_inv:nh3_kg +
annee_inv:n2o_t + nh3_kg:n2o_t + nh3_kg:TypeEPCI + n2o_t:TypeEPCI ,data=Data_mlg, family=binomial(link = "logit")), summary(modelcompletinter), modelcompletinter, test = "Chisq")
modelcompletinterred = glm(dep_met_1000~annee_inv + nh3_kg + n2o_t + TypeEPCI + annee_inv:nh3_kg +
annee_inv:n2o_t + nh3_kg:n2o_t + nh3_kg:TypeEPCI + n2o_t:TypeEPCI ,data=Data_mlg, family=binomial(link = "logit"))
anova(modelcompletinterred, summary(modelcompletinter), modelcompletinter, test="Chisq")
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter)
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg)))
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg)))
library(bestglm)
# Ici je refais la séléction des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(Data_mlg$ch4_t>1000)
summary(Data_mlg)
# Je retire la varaible quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
modelcompletadd = glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletadd)
pseudoR2 = 1 - modelcompletadd$deviance/modelcompletadd$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletadd)
step.backward = step(modelcompletadd, direction="backward",k=log(nrow(Data_mlg)))
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletadd)
# Les bestglm ne fonctionnent pas
bestglm(Data_mlg,family=binomial,IC="AIC")
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter)
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg)))
modelcompletinterred = glm(dep_met_1000~annee_inv + nh3_kg + n2o_t + TypeEPCI + annee_inv:nh3_kg +
annee_inv:n2o_t + nh3_kg:n2o_t + nh3_kg:TypeEPCI + n2o_t:TypeEPCI ,data=Data_mlg, family=binomial(link = "logit"))
anova(modelcompletinterred, summary(modelcompletinter), modelcompletinter, test="Chisq")
anova(modelcompletinterred, modelcompletinter, modelcompletinter, test="Chisq")
anova(modelcompletinterred, modelcompletinter, test="Chisq")
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(Data_mlg$ch4_t>1000)
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
# Les bestglm ne fonctionnent pas
#bestglm(Data_mlg,family=binomial,IC="AIC")
#bestglm(Data_mlg,family=binomial,IC="BIC")
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Les bestglm ne fonctionnent pas
bestglm(Data_mlg,family=binomial,IC="AIC")
# Les bestglm ne fonctionnent pas
#bestglm(Data_mlg,family=binomial,IC="AIC")
#bestglm(Data_mlg,family=binomial,IC="BIC")
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter, trace = F) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg)), trace = F) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Les bestglm ne fonctionnent pas
bestglm(Data_mlg,family=binomial,IC="AIC")
modelcompletadd = glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletadd)
pseudoR2 = 1 - modelcompletadd$deviance/modelcompletadd$null.deviance
pseudoR2
modelinterred = glm(dep_met_1000~annee_inv + nh3_kg + n2o_t + TypeEPCI + annee_inv:nh3_kg +
annee_inv:n2o_t + nh3_kg:n2o_t + nh3_kg:TypeEPCI + n2o_t:TypeEPCI ,data=Data_mlg, family=binomial(link = "logit"))
anova(modelinterred, modelcompletinter, test="Chisq")
anova(modelcompletadd, modelcompletinter, test="Chisq")
pseudoR2 = 1 - modelinterred$deviance/modelinterred$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletadd) # AIC
step.backward = step(modelcompletadd, direction="backward",k=log(nrow(Data_mlg))) # BIC
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(Data_mlg$ch4_t>1000)
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000) - 1)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.numeric(Data_mlg$ch4_t>1000) - 1
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.numeric(Data_mlg$ch4_t>1000) - 1
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.numeric(Data_mlg$ch4_t>1000)
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.numeric(Data_mlg$ch4_t>1000)
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
summary(Data_mlg)
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
summary(Data_mlg)
sum(Data_mlg$dep_met_1000)
summary(Data_mlg)
summary(Data_mlg)
sum(Data_mlg$dep_met_1000)
head(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
sum(Data_mlg$dep_met_1000)
library(corrplot)
library(tidyverse)
library(gridExtra)
library(reshape2)
library(ggplot2)
library(FactoMineR)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(corrplot)
library(tidyverse)
library(gridExtra)
library(reshape2)
library(ggplot2)
library(FactoMineR)
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
sum(Data_mlg$dep_met_1000)
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Modèle 2
modelinterred = glm(dep_met_1000~annee_inv + nh3_kg + n2o_t + TypeEPCI + annee_inv:nh3_kg +
annee_inv:n2o_t + nh3_kg:n2o_t + nh3_kg:TypeEPCI + n2o_t:TypeEPCI ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelinterred)
anova(modelinterred, modelcompletinter, test="Chisq")
# Modèle 3
modelcompletadd = glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletadd)
anova(modelcompletadd, modelcompletinter, test="Chisq")
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
summary(Data_mlg)
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
