Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(Data_mlg$ch4_t>1000)
summary(Data_mlg)
# Je retire la varaible quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
modelcompletadd = glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletadd)
pseudoR2 = 1 - modelcompletadd$deviance/modelcompletadd$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletadd)
step.backward = step(modelcompletadd, direction="backward",k=log(nrow(Data_mlg)))
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletadd)
# Les bestglm ne fonctionnent pas
bestglm(Data_mlg,family=binomial,IC="AIC")
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter)
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg)))
modelcompletinterred = glm(dep_met_1000~annee_inv + nh3_kg + n2o_t + TypeEPCI + annee_inv:nh3_kg +
annee_inv:n2o_t + nh3_kg:n2o_t + nh3_kg:TypeEPCI + n2o_t:TypeEPCI ,data=Data_mlg, family=binomial(link = "logit"))
anova(modelcompletinterred, summary(modelcompletinter), modelcompletinter, test="Chisq")
anova(modelcompletinterred, modelcompletinter, modelcompletinter, test="Chisq")
anova(modelcompletinterred, modelcompletinter, test="Chisq")
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(Data_mlg$ch4_t>1000)
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
# Les bestglm ne fonctionnent pas
#bestglm(Data_mlg,family=binomial,IC="AIC")
#bestglm(Data_mlg,family=binomial,IC="BIC")
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Les bestglm ne fonctionnent pas
bestglm(Data_mlg,family=binomial,IC="AIC")
# Les bestglm ne fonctionnent pas
#bestglm(Data_mlg,family=binomial,IC="AIC")
#bestglm(Data_mlg,family=binomial,IC="BIC")
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter, trace = F) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg)), trace = F) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Les bestglm ne fonctionnent pas
bestglm(Data_mlg,family=binomial,IC="AIC")
modelcompletadd = glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletadd)
pseudoR2 = 1 - modelcompletadd$deviance/modelcompletadd$null.deviance
pseudoR2
modelinterred = glm(dep_met_1000~annee_inv + nh3_kg + n2o_t + TypeEPCI + annee_inv:nh3_kg +
annee_inv:n2o_t + nh3_kg:n2o_t + nh3_kg:TypeEPCI + n2o_t:TypeEPCI ,data=Data_mlg, family=binomial(link = "logit"))
anova(modelinterred, modelcompletinter, test="Chisq")
anova(modelcompletadd, modelcompletinter, test="Chisq")
pseudoR2 = 1 - modelinterred$deviance/modelinterred$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletadd) # AIC
step.backward = step(modelcompletadd, direction="backward",k=log(nrow(Data_mlg))) # BIC
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(Data_mlg$ch4_t>1000)
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000) - 1)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.numeric(Data_mlg$ch4_t>1000) - 1
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.numeric(Data_mlg$ch4_t>1000) - 1
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.numeric(Data_mlg$ch4_t>1000)
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.numeric(Data_mlg$ch4_t>1000)
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
summary(Data_mlg)
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
summary(Data_mlg)
sum(Data_mlg$dep_met_1000)
summary(Data_mlg)
summary(Data_mlg)
sum(Data_mlg$dep_met_1000)
head(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
sum(Data_mlg$dep_met_1000)
library(corrplot)
library(tidyverse)
library(gridExtra)
library(reshape2)
library(ggplot2)
library(FactoMineR)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(corrplot)
library(tidyverse)
library(gridExtra)
library(reshape2)
library(ggplot2)
library(FactoMineR)
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
sum(Data_mlg$dep_met_1000)
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Modèle 2
modelinterred = glm(dep_met_1000~annee_inv + nh3_kg + n2o_t + TypeEPCI + annee_inv:nh3_kg +
annee_inv:n2o_t + nh3_kg:n2o_t + nh3_kg:TypeEPCI + n2o_t:TypeEPCI ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelinterred)
anova(modelinterred, modelcompletinter, test="Chisq")
# Modèle 3
modelcompletadd = glm(dep_met_1000~. ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletadd)
anova(modelcompletadd, modelcompletinter, test="Chisq")
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
summary(Data_mlg)
modelcompletinter = glm(dep_met_1000~(.)^2 ,data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
knitr::opts_chunk$set(echo = TRUE)
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Les bestglm ne fonctionnent pas
#bestglm(Data_mlg,family=binomial,IC="AIC")
#bestglm(Data_mlg,family=binomial,IC="BIC")
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Modèle 2
model2 = glm(dep_met_1000~annee_inv + nh3_kg + n2o_t + TypeEPCI + annee_inv:nh3_kg +
annee_inv:n2o_t + nh3_kg:n2o_t + nh3_kg:TypeEPCI + n2o_t:TypeEPCI ,data=Data_mlg, family=binomial(link = "logit"))
summary(model2)
anova(model2, modelcompletinter, test="Chisq")
pseudoR2 = 1 - modelinterred$deviance/modelinterred$null.deviance
pseudoR2
# Modèle 3
model3 = glm(dep_met_1000 ~ nh3_kg + n2o_t + TypeEPCI + nh3_kg:n2o_t,data=Data_mlg, family=binomial(link = "logit"))
summary(model3)
anova(model3, modelcompletinter, test="Chisq")
# Modèle 2
model2 = glm(dep_met_1000~annee_inv + nh3_kg + n2o_t + TypeEPCI + annee_inv:nh3_kg +
annee_inv:n2o_t + nh3_kg:n2o_t + nh3_kg:TypeEPCI + n2o_t:TypeEPCI ,data=Data_mlg, family=binomial(link = "logit"))
summary(model2)
$$
library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
# Je crée une nouvelle variable qualitative (celle qui traduit méthane > 1000t)
Data_mlg$dep_met_1000 <- as.factor(as.numeric(Data_mlg$ch4_t>1000))
summary(Data_mlg)
# Je retire la variable quantitative ch4_t
Data_mlg <- Data_mlg[c(1,2,4,5,6)]
summary(Data_mlg)
head(Data_mlg)
modelcompletinter = glm(dep_met_1000~(.)^2, data=Data_mlg, family=binomial(link = "logit"))
summary(modelcompletinter)
pseudoR2 = 1 - modelcompletinter$deviance/modelcompletinter$null.deviance
pseudoR2
# Les bestglm ne fonctionnent pas
#bestglm(Data_mlg,family=binomial,IC="AIC")
#bestglm(Data_mlg,family=binomial,IC="BIC")
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
# Quelque chose semble ne pas fonctionner dans les step.backward
step.backward = step(modelcompletinter) # AIC
step.backward = step(modelcompletinter, direction="backward",k=log(nrow(Data_mlg))) # BIC
library(bestglm)
#library(bestglm)
# TODO : à remettre en commun
# Ici je refais la sélection des variables (je ne leur applique ni log ni scale)
Data_mlg = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
Data_mlg$code_epci = as.factor(Data_mlg$code_epci)
Data_mlg$lib_epci = as.factor(Data_mlg$lib_epci)
Data_mlg$annee_inv = as.factor(Data_mlg$annee_inv)
Data_mlg$TypeEPCI = as.factor(Data_mlg$TypeEPCI)
# On prend les données quantitatives log
Data_mlg$nh3_kg = log(Data_mlg$nh3_kg)
Data_mlg$n2o_t = log(Data_mlg$n2o_t)
# Je retire les outliers
Data_mlg <- subset(Data_mlg, lib_epci != "Toulouse Métropole") #, "CC Pays de Nay"))
Data_mlg <- subset(Data_mlg, lib_epci != "CC Pays de Nay")
summary(Data_mlg)
# Je garde les variables qui m'intéresse
Data_mlg <- Data_mlg[c(3,10,12,14,15)]
summary(Data_mlg)
knitr::opts_chunk$set(echo = TRUE)
library(corrplot)
#library(tidyverse)
library(gridExtra)
library(reshape2)
library(ggplot2)
library(FactoMineR)
Data = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
head(Data)
Data$TypeEPCI=as.factor(Data$TypeEPCI)
Data$annee_inv=as.factor(Data$annee_inv)
Data$nomdepart=as.factor(Data$nomdepart)
Data$lib_epci=as.factor(Data$lib_epci)
Data$Ardèche = as.factor(Data$Ardèche)
Data$Ariège = as.factor(Data$Ariège)
Data$Aude = as.factor(Data$Aude)
Data$Aveyron = as.factor(Data$Aveyron)
Data$Gard = as.factor(Data$Gard)
Data$Haute.Garonne = as.factor(Data$Haute.Garonne)
Data$Gers = as.factor(Data$Gers)
Data$Hérault = as.factor(Data$Hérault)
Data$Landes = as.factor(Data$Landes)
Data$Lot = as.factor(Data$Lot)
Data$Lot.et.Garonne = as.factor(Data$Lot.et.Garonne)
Data$Lozère = as.factor(Data$Lozère)
Data$Pyrénées.Atlantiques = as.factor(Data$Pyrénées.Atlantiques)
Data$Hautes.Pyrénées = as.factor(Data$Hautes.Pyrénées)
Data$Pyrénées.Orientales = as.factor(Data$Pyrénées.Orientales)
Data$Tarn = as.factor(Data$Tarn)
Data$Tarn.et.Garonne = as.factor(Data$Tarn.et.Garonne)
Data$Vaucluse = as.factor(Data$Vaucluse)
summary(Data)
summary(Data)
str(Data)
inytex::install_tinytex()
tinytex::install_tinytex()
